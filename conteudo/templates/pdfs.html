{% extends 'base.html' %}

{% block conteudo %}
<div style="max-width: 800px; margin: 0 auto; padding: 20px;">
    <h2 style="text-align: center; margin-bottom: 30px;">Materiais Dispon√≠veis</h2>

    {% if pdfs %}
        {% for pdf in pdfs %}
            <div class="pdf-item">
                <div>
                    <h3 style="margin: 0 0 5px 0;">{{ pdf.titulo }}</h3>
                    <p style="margin: 0; color: #666; font-size: 0.9em;">
                        {{ pdf.materia.nome }} - {{ pdf.serie.nome }}
                    </p>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button onclick="abrirModal('{{ pdf.arquivo_pdf.url }}')" class="btn-visualizar" style="border: none; cursor: pointer;">
                        üëÅÔ∏è Ler Agora
                    </button>

                    <a href="{{ pdf.arquivo_pdf.url }}" class="btn-baixar" download>
                        ‚¨áÔ∏è Baixar
                    </a>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <div style="text-align: center; padding: 50px;">
            <h3>Nenhum material encontrado.</h3>
        </div>
    {% endif %}
    
    <div style="text-align: center; margin-top: 30px;">
        <a href="javascript:history.back()" style="color: #666;">‚Üê Voltar</a>
    </div>
</div>

<div id="pdfModal" class="modal-overlay" style="display: none;">
    <div class="modal-conteudo">
        <span class="fechar-modal" onclick="fecharModal()">&times;</span>
        
        <iframe id="pdfViewer" src="" width="100%" height="100%" style="border: none;"></iframe>
    </div>
</div>

<script>
    function abrirModal(urlPdf) {
        // 1. Pega o elemento do modal e do iframe
        var modal = document.getElementById("pdfModal");
        var iframe = document.getElementById("pdfViewer");
        
        // 2. Coloca o link do PDF dentro do iframe
        iframe.src = urlPdf;
        
        // 3. Mostra o modal (muda de display:none para flex)
        modal.style.display = "flex";
    }

    function fecharModal() {
        var modal = document.getElementById("pdfModal");
        var iframe = document.getElementById("pdfViewer");
        
        // 1. Esconde o modal
        modal.style.display = "none";
        
        // 2. Limpa o iframe (para parar de carregar o arquivo)
        iframe.src = "";
    }

    // Fecha o modal se clicar fora da caixa branca (opcional)
    window.onclick = function(event) {
        var modal = document.getElementById("pdfModal");
        if (event.target == modal) {
            fecharModal();
        }
    }
</script>
{% endblock %}